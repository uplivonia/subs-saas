(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{4530:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/channels/[id]",function(){return s(8712)}])},2588:function(e,t,s){"use strict";s.d(t,{Z:function(){return c}});var a=s(5893),l=s(1664),n=s.n(l),r=s(1163);let i=[{href:"/app/dashboard",label:"Dashboard"},{href:"/app/channels",label:"Channels"},{href:"/app/settings",label:"Settings"}];function c(e){let{title:t,children:s}=e,l=(0,r.useRouter)();return(0,a.jsxs)("div",{className:"min-h-screen bg-slate-50 text-slate-900 flex",children:[(0,a.jsxs)("aside",{className:"w-60 border-r border-slate-200 bg-white flex flex-col",children:[(0,a.jsx)("div",{className:"px-5 py-4 border-b border-slate-200",children:(0,a.jsxs)(n(),{href:"/",className:"text-lg font-bold tracking-tight",children:["subs",(0,a.jsx)("span",{className:"text-indigo-600",children:".saas"})]})}),(0,a.jsx)("nav",{className:"flex-1 px-3 py-4 space-y-1",children:i.map(e=>{let t=l.pathname.startsWith(e.href);return(0,a.jsx)(n(),{href:e.href,className:"block px-3 py-2 rounded-lg text-sm ".concat(t?"bg-indigo-50 text-indigo-700 font-medium":"text-slate-600 hover:bg-slate-100"),children:e.label},e.href)})}),(0,a.jsxs)("div",{className:"px-4 py-4 border-t border-slate-200 text-xs text-slate-500",children:[(0,a.jsx)("div",{children:"Logged in as"}),(0,a.jsx)("div",{className:"font-medium",children:"Creator"})]})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,a.jsxs)("header",{className:"h-14 border-b border-slate-200 bg-white flex items-center justify-between px-6",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-slate-700",children:t||"Dashboard"}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm text-slate-600",children:[(0,a.jsx)("span",{className:"hidden sm:inline",children:"fanstero.netlify.app"}),(0,a.jsx)("span",{className:"w-8 h-8 rounded-full bg-indigo-500 text-white flex items-center justify-center text-xs font-semibold",children:"CR"})]})]}),(0,a.jsx)("main",{className:"flex-1 px-6 py-6",children:s})]})]})}},8712:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var a=s(5893),l=s(2588),n=s(1163),r=s(7294);let i="https://subs-saas.onrender.com/api/v1",c="oneclicksub_bot";function o(){var e,t;let s=(0,n.useRouter)(),{id:o}=s.query,[d,x]=(0,r.useState)(null),[h,m]=(0,r.useState)([]),[p,u]=(0,r.useState)(!0),[b,f]=(0,r.useState)(!1),[j,g]=(0,r.useState)(""),[N,y]=(0,r.useState)(""),[v,w]=(0,r.useState)("30"),[k,_]=(0,r.useState)("EUR"),C="string"==typeof o?parseInt(o,10):Array.isArray(o)?parseInt(o[0],10):NaN,S=localStorage.getItem("token");(0,r.useEffect)(()=>{!C||Number.isNaN(C)||(async()=>{try{if(!S){u(!1);return}let e=await fetch("".concat(i,"/projects/").concat(C),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(S)}});if(!e.ok){console.error("Failed to load project:",await e.text()),u(!1);return}let t=await e.json();x(t);let s=await fetch("".concat(i,"/plans/project/").concat(C),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(S)}});if(!s.ok){console.error("Failed to load plans:",await s.text()),m([]),u(!1);return}let a=await s.json();m(a)}catch(e){console.error("Error while loading channel data:",e)}finally{u(!1)}})()},[C,S]);let E=async e=>{if(e.preventDefault(),!d||!S)return;let t=parseFloat(N.replace(",",".")),s=parseInt(v,10);if(!j||Number.isNaN(t)||Number.isNaN(s)){alert("Please fill in name, price and duration correctly.");return}f(!0);try{let e=await fetch("".concat(i,"/plans/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(S)},body:JSON.stringify({project_id:d.id,name:j,price:t,currency:k,duration_days:s,active:!0})});if(!e.ok){let t=await e.text();console.error("Failed to create plan:",t),alert("Failed to create plan. Please try again.");return}let a=await e.json();m(e=>[...e,a]),g(""),y(""),w("30"),_("EUR")}catch(e){console.error("Network error while creating plan:",e),alert("Network error while creating plan.")}finally{f(!1)}},T=async()=>{if(!d)return;let e="https://t.me/".concat(c,"?start=project_").concat(d.id);try{await navigator.clipboard.writeText(e),alert("Subscription link copied to clipboard!")}catch(t){alert("Subscription link: ".concat(e))}},D=(null==d?void 0:d.telegram_channel_id)?"connected":null!==(t=null==d?void 0:null===(e=d.settings)||void 0===e?void 0:e.status)&&void 0!==t?t:"pending",R=d&&"https://t.me/".concat(c,"?start=project_").concat(d.id);return(0,a.jsx)(l.Z,{title:"Channel settings",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,a.jsx)("button",{type:"button",onClick:()=>s.push("/app/channels"),className:"text-xs text-slate-500 hover:text-slate-700 mb-2",children:"← Back to channels"}),p&&(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"Loading…"}),!p&&!d&&(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"Channel not found or you don't have access to it."}),!p&&d&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white border border-slate-200 rounded-2xl p-5 shadow-sm",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-slate-900 mb-1",children:d.title||"Unnamed channel"}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:["Channel ID:"," ",d.telegram_channel_id?d.telegram_channel_id:"not linked yet"]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["Status:"," ",(0,a.jsx)("span",{className:"connected"===D?"text-emerald-600 font-medium":"text-amber-600 font-medium",children:D})]})]}),R&&(0,a.jsxs)("div",{className:"bg-white border border-slate-200 rounded-2xl p-5 shadow-sm space-y-2",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-900",children:"Subscription link"}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Share this link with your audience. They will open the bot and see your subscription plans for this channel."}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mt-2",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("code",{className:"block w-full text-xs bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 overflow-x-auto",children:R})}),(0,a.jsx)("button",{type:"button",onClick:T,className:"px-3 py-2 rounded-lg bg-indigo-600 text-white text-xs font-medium hover:bg-indigo-700 transition-colors",children:"Copy link"})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-slate-200 rounded-2xl p-5 shadow-sm space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-900",children:"Subscription plans"})}),0===h.length&&(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"You don't have any plans yet. Create your first paid subscription below."}),h.length>0&&(0,a.jsx)("div",{className:"space-y-3",children:h.map(e=>(0,a.jsxs)("div",{className:"border border-slate-200 rounded-xl px-3 py-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-900",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-0.5",children:[e.price," ",e.currency," / ",e.duration_days," days"]})]}),(0,a.jsx)("span",{className:"text-xs text-emerald-600 font-medium",children:"Active"})]},e.id))}),(0,a.jsxs)("form",{onSubmit:E,className:"mt-4 border-t border-slate-100 pt-4 space-y-3",children:[(0,a.jsx)("h3",{className:"text-xs font-semibold text-slate-800 uppercase tracking-wide",children:"Create new plan"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-3",children:[(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{className:"block text-xs text-slate-600 mb-1",children:"Name"}),(0,a.jsx)("input",{type:"text",value:j,onChange:e=>g(e.target.value),className:"w-full border border-slate-300 rounded-lg px-2 py-1.5 text-sm",placeholder:"Monthly access",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-slate-600 mb-1",children:"Price"}),(0,a.jsx)("input",{type:"text",value:N,onChange:e=>y(e.target.value),className:"w-full border border-slate-300 rounded-lg px-2 py-1.5 text-sm",placeholder:"9.99",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-slate-600 mb-1",children:"Currency"}),(0,a.jsxs)("select",{value:k,onChange:e=>_(e.target.value),className:"w-full border border-slate-300 rounded-lg px-2 py-1.5 text-sm bg-white",children:[(0,a.jsx)("option",{value:"EUR",children:"EUR"}),(0,a.jsx)("option",{value:"USD",children:"USD"})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-slate-600 mb-1",children:"Duration (days)"}),(0,a.jsx)("input",{type:"number",min:1,value:v,onChange:e=>w(e.target.value),className:"w-full border border-slate-300 rounded-lg px-2 py-1.5 text-sm",required:!0})]})}),(0,a.jsx)("button",{type:"submit",disabled:b,className:"mt-2 inline-flex items-center px-4 py-2 rounded-xl text-sm font-medium ".concat(b?"bg-slate-200 text-slate-500 cursor-wait":"bg-indigo-600 text-white hover:bg-indigo-700"),children:b?"Creating…":"Create plan"})]})]})]})]})})}},1163:function(e,t,s){e.exports=s(9090)}},function(e){e.O(0,[664,888,774,179],function(){return e(e.s=4530)}),_N_E=e.O()}]);